// --------------------------------------------------------
// Product Detail
// --------------------------------------------------------

$product-essential-width-small: 310px;
$product-essential-width:       520px;
$product-elements-gutter-small: 40px;
$product-elements-gutter:       100px;
$product-image-fade-transition: opacity 1200ms cubic-bezier(0.63, 0.16, 0.17, 1.02) 200ms;
$product-image-fade-transition-fast: opacity 500ms cubic-bezier(0.63, 0.16, 0.17, 1.02);

@mixin pdf-scrollable {
  @include display-flex;
  @include flex-direction(column);
  @include align-items(center);
  @include justify-content(center);
  margin: 0;

  @media (min-width: $screen-xs-min) {
    max-width: 100%;
    margin-left: $menu-clearance-min;
  }

  @media (min-width: $screen-sm-min) {
    min-height: calc(100vh - 200px);
    margin-right: 0;
    width: calc(100% - #{ $product-essential-width-small + $grid-gutter-width/2 + $menu-clearance-min });   
  }

  @media (min-width: $screen-lg-min) {
    width: calc(100% - #{ $product-essential-width + $grid-gutter-width + $menu-clearance-max });
    margin-left: $menu-clearance-max;
  }
}


// @TODO - Should these go in here or in layout.scss?
body.template-product {
  
  .wrap {
    padding-right: 0;
    padding-left: 0;
    @include justify-content(flex-start);
  }

  .layout-content-wrapper {
    margin-top: $header-height-mobile;

    @media (min-width: $screen-sm-min) {
      margin-top: 0;
      margin-bottom: 0;
    }

    // @media (max-width: $screen-sm-max) {
    //   margin-bottom: 250px;
    // }
  }
}

.product-detail-form {
  padding-bottom: $spacer;

  @media (min-width: $screen-sm-min) {
    padding-bottom: 0;
  }
}

// Responsive Form Visibility
// --------------------------------------------------------

.sticky-form {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background-color: $color-white;
  padding: 15px;
  padding-top: 0;
  border-top: 1px solid black;
  text-align: center;

  button[type="submit"] {
    width: 100%;
  }  

  @media (min-width: $screen-sm-min) {
    display: none;
  }
}

.desktop-form {
  display: none;

  @media (min-width: $screen-sm-min) {
    display: block;
  }
}

// Essential
// --------------------------------------------------------

.product-essential {

  @media (min-width: $screen-sm-min) {
    width: $product-essential-width-small;
    position: fixed;
    top: 50%;
    right: $grid-gutter-width/2;
    left: auto;
    bottom: auto;
    transform: translateY(-50%);
    padding: 0;
    padding-left: $product-elements-gutter-small;
    text-align: left;
    background-color: transparent;
    border-top: none;

    button[type="submit"] {
      width: 100%;
      min-width: 0;
    }
  }

  @media (min-width: $screen-lg-min) {
    width: $product-essential-width;
    padding-left: $product-elements-gutter;
    padding-right: $product-elements-gutter/2;
  }
}

.pdf-spaced-el {
  & + & {
    margin-top: $spacer * 0.75;
  }
}

.pdf-title {
  @include h5;
  margin: 0;
}

.pdf-subtitle {
  @include h6;
  font-size: $font-size-small;
  margin: $spacer/2 0 $spacer*1.25;
}

.pdf-price {
  font-size: $font-size-small
}

.pdf-description {
  font-size: $font-size-xsmall;
}

// Sticky Stuff

.sticky-row {
  @include display-flex;
  margin: 0 -15px;
  padding: 0 15px;
  font-size: $font-size-small;

  &.sticky-row--add-to-cart {
    padding-top: 15px;
  }

  & + & {
    border-top: 1px solid #e1e1e1;
  }

}


.sticky-row__entry {
  padding: 5px;
  @include flex(1);
  
  &:first-child {
    padding-left: 0;
    text-align: left;
  }
  &:last-child:not(:only-child) {
    padding-right: 0;
    text-align: right;
  }
}

// Secondary description at the bottom of the scroll container

.product-secondary-description {
  @include pdf-scrollable;

  @media (min-width: $screen-lg-min) {
    display: none;
  }
}

// Gallery
// --------------------------------------------------------

.product-galleries-wrapper {
  html.js & {
    opacity: 0;

    &.is-ready {
      opacity: 1;
      @include transition($product-image-fade-transition);
    }
  }
}

// Scroll Gallery
.product-gallery {
  @include pdf-scrollable;

  html.js & {
    opacity: 0;
    @include transition(opacity 450ms cubic-bezier(0.12, 0.27, 0.61, 0.93));

    &.is-active {
      opacity: 1;
      transition: opacity 700ms cubic-bezier(0.42, 0.1, 0.37, 0.97);
    }
  }

  &.is-zoomed {
    width: auto;
    margin: 0;
  }
}

.product-gallery__list {
  @include list-unstyled;
  margin: 0 auto;
  // max-width: 400px;

  @media (min-width: $screen-sm-min) {
    margin: 0;
    max-width: none;
  }
}

.product-gallery__item {
  position: relative;
  margin-bottom: 0;
  @include display-flex;
  @include align-items(center);
  min-height: 70vh;

  @media (min-width: $screen-sm-min) {
    min-height: 100vh;  
  }

  @media (min-width: $screen-lg-min) {
    height: 100vh;

    .product-gallery.is-zoomed & {
      height: auto;   
    }    
  }

  &:last-child:not(:only-child) {
    min-height: auto;
  }

  // Since space is tight on tiny screens, make the first one auto height so it doesn't get pushed down for any vertical centering reasons
  @media (max-width: $screen-xs-max) {
    &:first-child {
      min-height: auto;
    }
  }

  & + & {
    margin-top: $grid-gutter-width/2;
  }
}

.product-gallery__image {
  @include align-self(center);
  display: block;
  margin: 0 auto;
  width: 100%;
  object-fit: contain;

  @media (min-width: $screen-lg-min) {
    max-width: 900px;
    max-height: 100%;

    .product-gallery.is-zoomed & {
      max-width: 90%;
    }     
  }

  @media (min-width: $screen-xl-min) {
   .product-gallery.is-zoomed & {
      max-width: 1200px;
    } 
  }
  
  // Lazy loaded
  &[data-src] {
    opacity: 0;
  }

  &.is-loaded {
    opacity: 1;
    @include transition($product-image-fade-transition-fast);
    // @include transition(opacity $transition-duration-slow $transition-timing-function-in);
  }

}
